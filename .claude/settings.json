{
  "permissions": {
    "allow": [
      "Bash(atlas migrate diff --env local check_drift)",
      "Bash(bash scripts/check-migration-drift.sh)",
      "Bash(atlas migrate diff --env local drop_notifications_table)",
      "Bash(docker info)",
      "Bash(podman port postgres)",
      "Bash(PGPASSWORD=\"\" psql -U test-user -h localhost -d test-db -c \"SELECT 1\")",
      "Bash(atlas migrate diff --dev-url \"postgres://test-user@localhost:5432/atlas_dev_temp?sslmode=disable&search_path=app,public\" --dir \"file://k8s/atlas/base/migrations\" --to \"file://internal/infrastructure/database/rdb/schema/schema.sql\" drop_notifications_table)",
      "Bash(atlas migrate diff --dev-url \"postgres://test-user@localhost:5432/atlas_dev_temp?sslmode=disable&search_path=public\" --dir \"file://k8s/atlas/base/migrations\" --to \"file://internal/infrastructure/database/rdb/schema/schema.sql\" drop_notifications_table)",
      "Bash(atlas migrate diff --dev-url \"postgres://test-user@localhost:5432/atlas_dev_temp?sslmode=disable&search_path=app\" --dir \"file://k8s/atlas/base/migrations\" --to \"file://internal/infrastructure/database/rdb/schema/schema.sql\" drop_notifications_table)"
    ],
    "additionalDirectories": [
      "/home/pannpers/dev/src/github.com/liverty-music/backend",
      "/home/pannpers/.claude/skills",
      "/home/pannpers/.claude/skills/code-verifier",
      "/home/pannpers/dev/src/github.com/pannpers/dotfiles/agent/skills/code-verifier",
      "/home/pannpers/.claude/skills/db-migration",
      "/home/pannpers/dev/src/github.com/pannpers/dotfiles/agent/skills/db-migration",
      "/home/pannpers/.claude",
      "/home/pannpers/dev/src/github.com/pannpers/dotfiles/.claude"
    ]
  },
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Check if the file_path being written/edited is under 'k8s/atlas/base/migrations/'. If YES: this is a migration file being directly created or modified. Warn that Atlas best practice requires editing schema.sql first, then running 'atlas migrate diff'. Recommend using /db-migration skill. Return 'deny' with explanation UNLESS the tool input shows this is an atlas-generated file being amended with DML (data migration statements like INSERT/UPDATE). If the file is NOT under migrations/, return 'allow'."
          }
        ]
      }
    ]
  }
}
